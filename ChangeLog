------------------------------------------------------------
  add advanced features by rafael2k <rafael@riseup.net>
------------------------------------------------------------
  initial version
